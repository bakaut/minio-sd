geo $limit {
    default 1;
    192.168.1.100/32 0;
}

map $limit $limit_key {
    0 "";
    1 $binary_remote_addr;
}

limit_req_zone $limit_key zone=mylimit:64m rate=30r/s;